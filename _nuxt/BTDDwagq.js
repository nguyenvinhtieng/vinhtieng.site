import{c as $,_ as O,a as Q}from"./D6yy3yot.js";import{B as I,H as T,f as b,h as B,j as u,n as y,E as x,F as C,D as q,g as m,t as v,i as S,A,y as F,a as K,b as _,I as V,J as L,K as z,w as U}from"./BrfpwoiF.js";import{_ as H}from"./y_TWTjR6.js";import{u as J}from"./DKsMXMIU.js";import{u as W}from"./DY0FdTy0.js";import{q as N}from"./D7dfURIm.js";import"./BXNiYTkO.js";import"./BuvU_Vdk.js";const X={key:0,class:"flex justify-center mt-4"},Y={class:"inline-flex items-center gap-1"},Z=["disabled"],ee=["onClick"],te=["disabled"],ae=I({__name:"Pagination",props:{currentPage:{},totalItems:{},perPage:{},maxVisiblePages:{}},emits:["update:page"],setup(o,{emit:l}){const r=o,p=l,s=T(()=>Math.ceil(r.totalItems/r.perPage)),n=T(()=>{const e=r.maxVisiblePages??5,t=Math.floor(e/2);let a=Math.max(1,r.currentPage-t),i=Math.min(s.value,a+e-1);i-a<e-1&&(a=Math.max(1,i-e+1));const h=[];for(let f=a;f<=i;f++)h.push(f);return h});function c(e){e<1||e>s.value||e===r.currentPage||p("update:page",e)}return(e,t)=>s.value>1?(m(),b("nav",X,[u("ul",Y,[u("li",null,[u("button",{class:y(x($)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-700 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===1})),disabled:e.currentPage===1,onClick:t[0]||(t[0]=a=>c(e.currentPage-1))}," « ",10,Z)]),(m(!0),b(C,null,q(n.value,a=>(m(),b("li",{key:a},[u("button",{class:y(["w-10 rounded border border-neutral-200 aspect-square dark:border-neutral-800",{"bg-blue-500 text-white cursor-not-allowed":a===e.currentPage,"hover:bg-gray-100 cursor-pointer dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:text-neutral-200":a!==e.currentPage}]),onClick:i=>c(a)},v(a),11,ee)]))),128)),u("li",null,[u("button",{class:y(x($)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-600 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===s.value})),disabled:e.currentPage===s.value,onClick:t[1]||(t[1]=a=>c(e.currentPage+1))}," » ",10,te)])])])):B("",!0)}}),re={class:"flex-1 text-neutral-400 truncate pr-12"},se={class:"absolute inset-y-0 right-0 flex items-center gap-1 px-3 text-neutral-400"},ne=I({__name:"SearchInput",props:{size:{type:String,default:"md"}},setup(o){const l=J(),r=()=>{l.toggleOpenSearchDialog()};return(p,s)=>{const n=H;return m(),b("div",{onClick:r,class:y(x($)("relative w-full max-w-md border-gray-300 rounded-lg shadow-sm flex focus:ring-2 cursor-pointer dark:border-white dark:shadow-neutral-800",{"text-sm px-4 py-2":o.size==="md","text-lg px-6 py-3":o.size==="lg","text-xs px-2 py-1":o.size==="sm"}))},[u("p",re,v(p.$t("search.placeholder")),1),u("button",se,[S(n,{name:"window",class:"text-lg"}),s[0]||(s[0]=A(" + ")),s[1]||(s[1]=u("span",{class:"font-mono text-xs"},"K",-1))])],2)}}});async function oe(){var r;const{data:o}=await W("blog-tags",()=>N("blog").select("tags").all());return(r=o.value)==null?void 0:r.reduce((p,s)=>((s.tags||[]).forEach(c=>p.add(c)),p),new Set)}function le(){const o=F(),l=K();return{setParam:(e,t)=>{const a={...o.query};t==null||t===""?delete a[e]:a[e]=t.toString(),l.replace({query:a})},removeParam:e=>{const t={...o.query};delete t[e],l.push({query:t})},setParams:e=>{const t={...o.query};for(const[a,i]of Object.entries(e))i==null||i===""?delete t[a]:t[a]=i.toString();l.push({query:t})},route:o,getParam:e=>o.query[e],getParams:()=>o.query}}const ue={class:"min-h-screen text-gray-800 dark:text-gray-100 p-container z-10 pt-10"},ce={class:"flex items-center justify-center mb-4"},ie={class:"flex flex-wrap gap-2 mb-4"},de={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},ge={key:0,class:"text-center text-gray-500"},w=9,D="tags",j="page",ye=I({__name:"index",async setup(o){var E;let l,r;const{setParams:p,getParam:s}=le(),n=_(((E=s(D))==null?void 0:E.split(","))||[]),c=_(parseInt(s(j)||"1")||1),e=_([]),t=_(0),a=([l,r]=V(()=>oe()),l=await l,r(),l),i=async()=>{const g=()=>{let d=N("blog").where("published","=",!0).order("date","DESC");return n.value.length&&(d=d.orWhere(P=>(n.value.forEach(G=>{P=P.where("tags","LIKE",`%${G}%`)}),P))),d},M=await g().limit(w).skip((c.value-1)*w).all(),k=await g().count();e.value=M,t.value=k};[l,r]=V(()=>i()),await l,r(),L([n,c],async()=>{p({[D]:n.value.join(","),[j]:c.value.toString()}),await i()},{deep:!0});const h=g=>{c.value=g},f=g=>{n.value.includes(g)?n.value.splice(n.value.indexOf(g),1):n.value.push(g),h(1)},R=()=>{c.value=1,n.value=[],i()};return(g,M)=>{const k=Q;return m(),b("main",ue,[u("div",ce,[S(ne)]),u("div",ie,[(m(!0),b(C,null,q(x(a),d=>(m(),z(O,{key:d,label:d,"is-active":n.value.includes(d),onClick:P=>f(d)},{default:U(()=>[A(v(d),1)]),_:2},1032,["label","is-active","onClick"]))),128))]),u("div",de,[(m(!0),b(C,null,q(e.value,d=>(m(),z(k,{key:d.id,post:d},null,8,["post"]))),128))]),e.value.length===0?(m(),b("div",ge,[u("p",null,[A(v(g.$t("no_posts"))+" ",1),u("span",{onClick:R,class:"text-blue-500 hover:underline cursor-pointer"},v(g.$t("refresh")),1)])])):B("",!0),S(ae,{currentPage:c.value,totalItems:t.value,perPage:w,maxVisiblePages:5,"onUpdate:page":h},null,8,["currentPage","totalItems"])])}}});export{ye as default};
