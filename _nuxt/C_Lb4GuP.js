import{c as C,_ as O,a as Q}from"./DvkkPSk4.js";import{u as R}from"./CJ7mpz-_.js";import{A as E,G as T,d as h,f as j,h as c,n as x,D as k,F as q,C as A,e as m,t as v,g as S,z as I,v as F,a as K,H as U,r as y,I as z,J as H,K as J,L as V,w as W}from"./Brlg86Z1.js";import X from"./BYUkt1SR.js";import{u as Y}from"./DU2B-B07.js";import{q as B}from"./CPuOhrwY.js";import"./CviTl9oX.js";import"./DNgArL8l.js";const Z={key:0,class:"flex justify-center mt-4"},ee={class:"inline-flex items-center gap-1"},te=["disabled"],re=["onClick"],ae=["disabled"],se=E({__name:"Pagination",props:{currentPage:{},totalItems:{},perPage:{},maxVisiblePages:{}},emits:["update:page"],setup(n,{emit:o}){const a=n,p=o,s=T(()=>Math.ceil(a.totalItems/a.perPage)),l=T(()=>{const e=a.maxVisiblePages??5,t=Math.floor(e/2);let r=Math.max(1,a.currentPage-t),d=Math.min(s.value,r+e-1);d-r<e-1&&(r=Math.max(1,d-e+1));const b=[];for(let f=r;f<=d;f++)b.push(f);return b});function i(e){e<1||e>s.value||e===a.currentPage||p("update:page",e)}return(e,t)=>s.value>1?(m(),h("nav",Z,[c("ul",ee,[c("li",null,[c("button",{class:x(k(C)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-700 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===1})),disabled:e.currentPage===1,onClick:t[0]||(t[0]=r=>i(e.currentPage-1))}," « ",10,te)]),(m(!0),h(q,null,A(l.value,r=>(m(),h("li",{key:r},[c("button",{class:x(["w-10 rounded border border-neutral-200 aspect-square dark:border-neutral-800",{"bg-blue-500 text-white cursor-not-allowed":r===e.currentPage,"hover:bg-gray-100 cursor-pointer dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:text-neutral-200":r!==e.currentPage}]),onClick:d=>i(r)},v(r),11,re)]))),128)),c("li",null,[c("button",{class:x(k(C)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-600 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===s.value})),disabled:e.currentPage===s.value,onClick:t[1]||(t[1]=r=>i(e.currentPage+1))}," » ",10,ae)])])])):j("",!0)}}),ne={class:"flex-1 text-neutral-400 truncate pr-12"},oe={class:"absolute inset-y-0 right-0 flex items-center gap-1 px-3 text-neutral-400"},le=E({__name:"SearchInput",props:{size:{type:String,default:"md"}},setup(n){const o=Y(),a=()=>{o.toggleOpenSearchDialog()};return(p,s)=>{const l=X;return m(),h("div",{onClick:a,class:x(k(C)("relative w-full max-w-md border-gray-300 rounded-lg shadow-sm flex focus:ring-2 cursor-pointer dark:border-white dark:shadow-neutral-800",{"text-sm px-4 py-2":n.size==="md","text-lg px-6 py-3":n.size==="lg","text-xs px-2 py-1":n.size==="sm"}))},[c("p",ne,v(p.$t("search.placeholder")),1),c("button",oe,[S(l,{name:"ic:baseline-window",class:"w-4 h-4"}),s[0]||(s[0]=I(" + ")),s[1]||(s[1]=c("span",{class:"font-mono text-xs"},"K",-1))])],2)}}});async function ue(){var a;const{data:n}=await R("blog-tags",()=>B("blog").select("tags").all());return(a=n.value)==null?void 0:a.reduce((p,s)=>((s.tags||[]).forEach(i=>p.add(i)),p),new Set)}function ce(){const n=F(),o=K();return{setParam:(e,t)=>{const r={...n.query};t==null||t===""?delete r[e]:r[e]=t.toString(),o.replace({query:r})},removeParam:e=>{const t={...n.query};delete t[e],o.push({query:t})},setParams:e=>{const t={...n.query};for(const[r,d]of Object.entries(e))d==null||d===""?delete t[r]:t[r]=d.toString();o.push({query:t})},route:n,getParam:e=>n.query[e],getParams:()=>n.query}}const ie={class:"min-h-screen text-gray-800 dark:text-gray-100 p-container z-10 pt-10"},de={class:"flex items-center justify-center mb-4"},ge={class:"flex flex-wrap gap-2 mb-4"},me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},pe={key:0,class:"text-center text-gray-500"},$=9,D="tags",G="page",ke=E({__name:"index",async setup(n){var M;let o,a;U();const{setParams:p,getParam:s}=ce(),l=y(((M=s(D))==null?void 0:M.split(","))||[]),i=y(parseInt(s(G)||"1")||1),e=y([]),t=y(0),r=([o,a]=z(()=>ue()),o=await o,a(),o);H([l,i],u=>{p({[D]:u[0].join(","),[G]:u[1].toString()})},{deep:!0}),J(()=>{d()});async function d(){const u=()=>{let g=B("blog").where("published","=",!0);return l.value.length&&(g=g.orWhere(_=>(l.value.forEach(N=>{_=_.where("tags","LIKE",`%${N}%`)}),_))),g},w=await u().limit($).skip((i.value-1)*$).all(),P=await u().count();return e.value=w,t.value=P,{posts:w,totalPosts:P}}const b=u=>{i.value=u},f=u=>{l.value.includes(u)?l.value.splice(l.value.indexOf(u),1):l.value.push(u),b(1)};[o,a]=z(()=>R("filtered-blog",d)),await o,a();const L=()=>{i.value=1,l.value=[]};return(u,w)=>{const P=Q;return m(),h("main",ie,[c("div",de,[S(le)]),c("div",ge,[(m(!0),h(q,null,A(k(r),g=>(m(),V(O,{key:g,label:g,"is-active":l.value.includes(g),onClick:_=>f(g)},{default:W(()=>[I(v(g),1)]),_:2},1032,["label","is-active","onClick"]))),128))]),c("div",me,[(m(!0),h(q,null,A(e.value,g=>(m(),V(P,{key:g.id,post:g},null,8,["post"]))),128))]),e.value.length===0?(m(),h("div",pe,[c("p",null,[I(v(u.$t("no_posts"))+" ",1),c("span",{onClick:L,class:"text-blue-500 hover:underline cursor-pointer"},v(u.$t("refresh")),1)])])):j("",!0),S(se,{currentPage:i.value,totalItems:t.value,perPage:$,maxVisiblePages:5,"onUpdate:page":b},null,8,["currentPage","totalItems"])])}}});export{ke as default};
