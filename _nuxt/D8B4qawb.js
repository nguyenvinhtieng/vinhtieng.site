import{c as A,_ as Q,a as F}from"./UE7jap21.js";import{_ as K}from"./iKc3Mqv4.js";import{u as R}from"./CmoTRDtl.js";import{A as E,G as z,c as b,e as j,g as c,n as k,D as v,F as S,C as I,d as m,t as P,f as w,z as $,q as U,a as H,H as J,r as x,I as V,J as W,K as X,w as D,L as G}from"./dTqwWHMG.js";import Y from"./oNds7706.js";import{u as Z}from"./CIpeUEZh.js";import{q as B}from"./TourFunG.js";import"./DfYTZ8Zi.js";const ee={key:0,class:"flex justify-center mt-4"},te={class:"inline-flex items-center gap-1"},ae=["disabled"],re=["onClick"],se=["disabled"],ne=E({__name:"Pagination",props:{currentPage:{},totalItems:{},perPage:{},maxVisiblePages:{}},emits:["update:page"],setup(s,{emit:n}){const r=s,g=n,o=z(()=>Math.ceil(r.totalItems/r.perPage)),p=z(()=>{const e=r.maxVisiblePages??5,t=Math.floor(e/2);let a=Math.max(1,r.currentPage-t),d=Math.min(o.value,a+e-1);d-a<e-1&&(a=Math.max(1,d-e+1));const h=[];for(let f=a;f<=d;f++)h.push(f);return h});function l(e){e<1||e>o.value||e===r.currentPage||g("update:page",e)}return(e,t)=>o.value>1?(m(),b("nav",ee,[c("ul",te,[c("li",null,[c("button",{class:k(v(A)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-700 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===1})),disabled:e.currentPage===1,onClick:t[0]||(t[0]=a=>l(e.currentPage-1))}," « ",10,ae)]),(m(!0),b(S,null,I(p.value,a=>(m(),b("li",{key:a},[c("button",{class:k(["w-10 rounded border border-neutral-200 aspect-square dark:border-neutral-800",{"bg-blue-500 text-white cursor-not-allowed":a===e.currentPage,"hover:bg-gray-100 cursor-pointer dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:text-neutral-200":a!==e.currentPage}]),onClick:d=>l(a)},P(a),11,re)]))),128)),c("li",null,[c("button",{class:k(v(A)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-600 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===o.value})),disabled:e.currentPage===o.value,onClick:t[1]||(t[1]=a=>l(e.currentPage+1))}," » ",10,se)])])])):j("",!0)}}),oe={class:"flex-1 text-neutral-400 truncate pr-12"},le={class:"absolute inset-y-0 right-0 flex items-center gap-1 px-3 text-neutral-400"},ue=E({__name:"SearchInput",props:{size:{type:String,default:"md"}},setup(s){const n=Z(),r=()=>{n.toggleOpenSearchDialog()};return(g,o)=>{const p=Y;return m(),b("div",{onClick:r,class:k(v(A)("relative w-full max-w-md border-gray-300 rounded-lg shadow-sm flex focus:ring-2 cursor-pointer dark:border-white dark:shadow-neutral-800",{"text-sm px-4 py-2":s.size==="md","text-lg px-6 py-3":s.size==="lg","text-xs px-2 py-1":s.size==="sm"}))},[c("p",oe,P(g.$t("search.placeholder")),1),c("button",le,[w(p,{name:"ic:baseline-window",class:"w-4 h-4"}),o[0]||(o[0]=$(" + ")),o[1]||(o[1]=c("span",{class:"font-mono text-xs"},"K",-1))])],2)}}});async function ce(){var r;const{data:s}=await R("blog-tags",()=>B("blog").select("tags").all());return(r=s.value)==null?void 0:r.reduce((g,o)=>((o.tags||[]).forEach(l=>g.add(l)),g),new Set)}function ie(){const s=U(),n=H();return{setParam:(e,t)=>{const a={...s.query};t==null||t===""?delete a[e]:a[e]=t.toString(),n.replace({query:a})},removeParam:e=>{const t={...s.query};delete t[e],n.push({query:t})},setParams:e=>{const t={...s.query};for(const[a,d]of Object.entries(e))d==null||d===""?delete t[a]:t[a]=d.toString();n.push({query:t})},route:s,getParam:e=>s.query[e],getParams:()=>s.query}}const de={class:"min-h-screen text-gray-800 dark:text-gray-100 p-container z-10 pt-10"},me={class:"flex items-center justify-center mb-4"},ge={class:"flex flex-wrap gap-2 mb-4"},pe={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},be={key:0,class:"text-center text-gray-500"},q=9,L="tags",N="page",we=E({__name:"index",async setup(s){var M;let n,r;const g=J(),{setParams:o,getParam:p}=ie(),l=x(((M=p(L))==null?void 0:M.split(","))||[]),e=x(parseInt(p(N)||"1")||1),t=x([]),a=x(0),d=([n,r]=V(()=>ce()),n=await n,r(),n);W([l,e],u=>{o({[L]:u[0].join(","),[N]:u[1].toString()})},{deep:!0}),X(()=>{h()});async function h(){const u=()=>{let _=B("blog").where("published","=",!0);return l.value.length&&(_=_.orWhere(i=>(l.value.forEach(T=>{i=i.where("tags","LIKE",`%${T}%`)}),i))),_},C=await u().limit(q).skip((e.value-1)*q).all(),y=await u().count();return t.value=C,a.value=y,{posts:C,totalPosts:y}}const f=u=>{e.value=u},O=u=>{l.value.includes(u)?l.value.splice(l.value.indexOf(u),1):l.value.push(u),f(1)};return[n,r]=V(()=>R("filtered-blog",h)),await n,r(),(u,C)=>{const y=F,_=K;return m(),b("main",de,[c("div",me,[w(ue)]),c("div",ge,[(m(!0),b(S,null,I(v(d),i=>(m(),G(Q,{key:i,label:i,"is-active":l.value.includes(i),onClick:T=>O(i)},{default:D(()=>[$(P(i),1)]),_:2},1032,["label","is-active","onClick"]))),128))]),c("div",pe,[(m(!0),b(S,null,I(t.value,i=>(m(),G(y,{key:i.id,post:i},null,8,["post"]))),128))]),t.value.length===0?(m(),b("div",be,[c("p",null,[$(P(u.$t("no_posts"))+" ",1),w(_,{to:v(g)("/blog"),class:"text-blue-500 hover:underline"},{default:D(()=>[$(P(u.$t("refresh")),1)]),_:1},8,["to"])])])):j("",!0),w(ne,{currentPage:e.value,totalItems:a.value,perPage:q,maxVisiblePages:5,"onUpdate:page":f},null,8,["currentPage","totalItems"])])}}});export{we as default};
