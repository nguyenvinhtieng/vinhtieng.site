import{c as C,_ as O,a as Q}from"./DL7vkca_.js";import{u as D}from"./Bxx4I_vo.js";import{B as E,H as T,f,h as N,j as c,n as x,E as k,F as q,D as A,g as m,t as P,i as S,A as I,y as F,a as K,I as U,b as y,J as z,K as H,L as J,M as V,w as W}from"./CeR8_7aI.js";import{_ as X}from"./szrCEfQo.js";import{u as Y}from"./B9dIb4Q4.js";import{q as R}from"./CxudqaLt.js";import"./DPZJowwf.js";import"./3Jg4squ_.js";const Z={key:0,class:"flex justify-center mt-4"},ee={class:"inline-flex items-center gap-1"},te=["disabled"],ae=["onClick"],re=["disabled"],se=E({__name:"Pagination",props:{currentPage:{},totalItems:{},perPage:{},maxVisiblePages:{}},emits:["update:page"],setup(n,{emit:o}){const r=n,p=o,s=T(()=>Math.ceil(r.totalItems/r.perPage)),l=T(()=>{const e=r.maxVisiblePages??5,t=Math.floor(e/2);let a=Math.max(1,r.currentPage-t),d=Math.min(s.value,a+e-1);d-a<e-1&&(a=Math.max(1,d-e+1));const b=[];for(let h=a;h<=d;h++)b.push(h);return b});function i(e){e<1||e>s.value||e===r.currentPage||p("update:page",e)}return(e,t)=>s.value>1?(m(),f("nav",Z,[c("ul",ee,[c("li",null,[c("button",{class:x(k(C)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-700 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===1})),disabled:e.currentPage===1,onClick:t[0]||(t[0]=a=>i(e.currentPage-1))}," « ",10,te)]),(m(!0),f(q,null,A(l.value,a=>(m(),f("li",{key:a},[c("button",{class:x(["w-10 rounded border border-neutral-200 aspect-square dark:border-neutral-800",{"bg-blue-500 text-white cursor-not-allowed":a===e.currentPage,"hover:bg-gray-100 cursor-pointer dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:text-neutral-200":a!==e.currentPage}]),onClick:d=>i(a)},P(a),11,ae)]))),128)),c("li",null,[c("button",{class:x(k(C)("w-10 rounded border border-neutral-200 aspect-square hover:bg-neutral-100 cursor-pointer disabled:bg-neutral-200 dark:border-neutral-800 dark:bg-neutral-900 dark:hover:bg-neutral-800 dark:disabled:bg-neutral-600 dark:text-neutral-400",{"cursor-not-allowed":e.currentPage===s.value})),disabled:e.currentPage===s.value,onClick:t[1]||(t[1]=a=>i(e.currentPage+1))}," » ",10,re)])])])):N("",!0)}}),ne={class:"flex-1 text-neutral-400 truncate pr-12"},oe={class:"absolute inset-y-0 right-0 flex items-center gap-1 px-3 text-neutral-400"},le=E({__name:"SearchInput",props:{size:{type:String,default:"md"}},setup(n){const o=Y(),r=()=>{o.toggleOpenSearchDialog()};return(p,s)=>{const l=X;return m(),f("div",{onClick:r,class:x(k(C)("relative w-full max-w-md border-gray-300 rounded-lg shadow-sm flex focus:ring-2 cursor-pointer dark:border-white dark:shadow-neutral-800",{"text-sm px-4 py-2":n.size==="md","text-lg px-6 py-3":n.size==="lg","text-xs px-2 py-1":n.size==="sm"}))},[c("p",ne,P(p.$t("search.placeholder")),1),c("button",oe,[S(l,{name:"window",class:"text-lg"}),s[0]||(s[0]=I(" + ")),s[1]||(s[1]=c("span",{class:"font-mono text-xs"},"K",-1))])],2)}}});async function ue(){var r;const{data:n}=await D("blog-tags",()=>R("blog").select("tags").all());return(r=n.value)==null?void 0:r.reduce((p,s)=>((s.tags||[]).forEach(i=>p.add(i)),p),new Set)}function ce(){const n=F(),o=K();return{setParam:(e,t)=>{const a={...n.query};t==null||t===""?delete a[e]:a[e]=t.toString(),o.replace({query:a})},removeParam:e=>{const t={...n.query};delete t[e],o.push({query:t})},setParams:e=>{const t={...n.query};for(const[a,d]of Object.entries(e))d==null||d===""?delete t[a]:t[a]=d.toString();o.push({query:t})},route:n,getParam:e=>n.query[e],getParams:()=>n.query}}const ie={class:"min-h-screen text-gray-800 dark:text-gray-100 p-container z-10 pt-10"},de={class:"flex items-center justify-center mb-4"},ge={class:"flex flex-wrap gap-2 mb-4"},me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},pe={key:0,class:"text-center text-gray-500"},$=9,j="tags",B="page",ke=E({__name:"index",async setup(n){var M;let o,r;U();const{setParams:p,getParam:s}=ce(),l=y(((M=s(j))==null?void 0:M.split(","))||[]),i=y(parseInt(s(B)||"1")||1),e=y([]),t=y(0),a=([o,r]=z(()=>ue()),o=await o,r(),o);H([l,i],u=>{p({[j]:u[0].join(","),[B]:u[1].toString()})},{deep:!0}),J(()=>{d()});async function d(){const u=()=>{let g=R("blog").where("published","=",!0);return l.value.length&&(g=g.orWhere(_=>(l.value.forEach(L=>{_=_.where("tags","LIKE",`%${L}%`)}),_))),g},w=await u().limit($).skip((i.value-1)*$).all(),v=await u().count();return e.value=w,t.value=v,{posts:w,totalPosts:v}}const b=u=>{i.value=u},h=u=>{l.value.includes(u)?l.value.splice(l.value.indexOf(u),1):l.value.push(u),b(1)};[o,r]=z(()=>D("filtered-blog",d)),await o,r();const G=()=>{i.value=1,l.value=[]};return(u,w)=>{const v=Q;return m(),f("main",ie,[c("div",de,[S(le)]),c("div",ge,[(m(!0),f(q,null,A(k(a),g=>(m(),V(O,{key:g,label:g,"is-active":l.value.includes(g),onClick:_=>h(g)},{default:W(()=>[I(P(g),1)]),_:2},1032,["label","is-active","onClick"]))),128))]),c("div",me,[(m(!0),f(q,null,A(e.value,g=>(m(),V(v,{key:g.id,post:g},null,8,["post"]))),128))]),e.value.length===0?(m(),f("div",pe,[c("p",null,[I(P(u.$t("no_posts"))+" ",1),c("span",{onClick:G,class:"text-blue-500 hover:underline cursor-pointer"},P(u.$t("refresh")),1)])])):N("",!0),S(se,{currentPage:i.value,totalItems:t.value,perPage:$,maxVisiblePages:5,"onUpdate:page":b},null,8,["currentPage","totalItems"])])}}});export{ke as default};
